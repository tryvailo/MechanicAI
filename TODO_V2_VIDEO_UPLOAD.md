# ๐น TODO v2: ะะฐะณััะทะบะฐ ะฒะธะดะตะพ + ะฟะพะบะฐะดัะพะฒัะน ะฐะฝะฐะปะธะท

> **ะกัะฐััั**: ะัะปะพะถะตะฝะพ ะดะพ ะฒะตััะธะธ 2.0
> **ะัะธะพัะธัะตั**: Medium
> **ะกะปะพะถะฝะพััั**: Medium-High
> **ะัะตะฝะบะฐ ะฒัะตะผะตะฝะธ**: 4-10 ัะฐัะพะฒ (ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั scope)

---

## ๐ฏ ะะฐัะตะผ ััะพ ะฝัะถะฝะพ (ัะฒัะทั ั ะขะ)

### ะขัะตะฑะพะฒะฐะฝะธะต ะธะท ะขะ:
> "ะะฟัะตะดะตะปะตะฝะธะต ะฟะพ ะฒะธะดะตะพ"

### ะัะพะฑะปะตะผั ัะตะบััะตะณะพ ัะตัะตะฝะธั:

| ะะตะถะธะผ | ะะณัะฐะฝะธัะตะฝะธะต |
|-------|-------------|
| **ะคะพัะพ-ะฐะฝะฐะปะธะท** | ะกัะฐัะธัะฝัะน ะผะพะผะตะฝั โ ะฝะต ะฒะธะดะฝะพ ะดะฒะธะถะตะฝะธะต, ะผะธะณะฐะฝะธะต, ะทะฒัะบ |
| **Real-time ะฒะธะดะตะพ** | ะขัะตะฑัะตั ะฟะพััะพัะฝะฝะพะณะพ ัะพะตะดะธะฝะตะฝะธั, ัะฐะฑะพัะฐะตั ัะพะปัะบะพ "ะทะดะตัั ะธ ัะตะนัะฐั", ะฝะตะปัะทั ะพัะฟัะฐะฒะธัั ะทะฐะฟะธัั |

### Use Cases ะบะพัะพััะต ัะตัะฐะตั ะทะฐะณััะทะบะฐ ะฒะธะดะตะพ:

1. **๐ ะะฒัะบะธ ะดะฒะธะณะฐัะตะปั**
   - ะะพะปัะทะพะฒะฐัะตะปั ะทะฐะฟะธััะฒะฐะตั ะฒะธะดะตะพ ัะพ ะทะฒัะบะพะผ ัััะบะฐ/ัะฒะธััะฐ
   - AI ะฐะฝะฐะปะธะทะธััะตั ะฐัะดะธะพ + ะฒะธะดะตะพ ะฒะผะตััะต
   - ะัะธะผะตั: "ะกะปััะตะฝ ะผะตัะฐะปะปะธัะตัะบะธะน ัััะบ ะฟัะธ 2000 ะพะฑ/ะผะธะฝ โ ะฟะพัะพะถะต ะฝะฐ ะธะทะฝะพั ะณะธะดัะพะบะพะผะฟะตะฝัะฐัะพัะพะฒ"

2. **โ๏ธ ะะธะณะฐััะธะต ะธะฝะดะธะบะฐัะพัั**
   - ะะฐ ัะพัะพ ะฝะตะฒะพะทะผะพะถะฝะพ ะฟะพะฝััั ะผะธะณะฐะตั ะปะธ Check Engine (ะบัะธัะธัะฝะพ!) ะธะปะธ ะณะพัะธั ะฟะพััะพัะฝะฝะพ
   - ะะธะดะตะพ ะฟะพะบะฐะถะตั ะฟะฐััะตัะฝ ะผะธะณะฐะฝะธั
   - ะัะธะผะตั: "Check Engine ะผะธะณะฐะตั โ ััะพ misfire, ัะฝะธะทััะต ัะบะพัะพััั!"

3. **๐จ ะัะผ ะธะท ะฒััะปะพะฟะฐ**
   - ะฆะฒะตั ะดัะผะฐ (ะฑะตะปัะน/ัะธะฝะธะน/ัะตัะฝัะน) ะธ ะตะณะพ ะดะธะฝะฐะผะธะบะฐ
   - ะะฐ ัะพัะพ ะผะพะถะตั ะฑััั ะฝะตะพัะตะฒะธะดะฝะพ
   - ะัะธะผะตั: "ะกะธะฝะธะน ะดัะผ ะฟัะธ ัะฐะทะณะพะฝะต โ ะผะฐัะปะพ ะฟะพะฟะฐะดะฐะตั ะฒ ะบะฐะผะตัั ัะณะพัะฐะฝะธั"

4. **๐ ะะพะฒะตะดะตะฝะธะต ะฐะฒัะพ ะฟัะธ ะดะฒะธะถะตะฝะธะธ**
   - ะะธะฑัะฐัะธั, ััะฒะบะธ, ัััะฐะฝะฝะพะต ะฟะพะฒะตะดะตะฝะธะต ะฟะพะดะฒะตัะบะธ
   - ะะพะปัะทะพะฒะฐัะตะปั ัะฝะธะผะฐะตั ะธะท ัะฐะปะพะฝะฐ ะธะปะธ ัะฝะฐััะถะธ
   - ะัะธะผะตั: "ะะธะดะฝะฐ ะฒะธะฑัะฐัะธั ััะปั ะฝะฐ ัะบะพัะพััะธ 80-100 ะบะผ/ั โ ะฑะฐะปะฐะฝัะธัะพะฒะบะฐ ะบะพะปัั"

5. **๐ง ะัะพะฒะตัะบะฐ ะฟัะพัะตััะฐ ัะตะผะพะฝัะฐ**
   - ะะพะปัะทะพะฒะฐัะตะปั ัะฝะธะผะฐะตั ะบะฐะบ ะพะฝ ััะพ-ัะพ ะดะตะปะฐะตั
   - AI ะฟัะพะฒะตััะตั ะฟัะฐะฒะธะปัะฝะพััั ะดะตะนััะฒะธะน
   - ะัะธะผะตั: "ะะธะถั ััะพ ะฑะพะปั ะทะฐััะฝัั ะฝะต ะดะพ ะบะพะฝัะฐ โ ะดะพะบัััะธัะต ะดะพ ัะฟะพัะฐ"

---

## ๐ง ะขะตัะฝะธัะตัะบะฐั ัะตะฐะปะธะทะฐัะธั (ะฟะปะฐะฝ)

### ะััะธัะตะบัััะฐ:

```
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโ
โ  User uploads   โโโโโโถโ  Frame extraction โโโโโโถโ  Vision API     โ
โ  video file     โ     โ  (1 frame/2-3sec) โ     โ  (parallel)     โ
โ  .mp4/.mov/.webmโ     โ                   โ     โ                 โ
โโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโฌโโโโโโโโโ
                                                          โ
                        โโโโโโโโโโโโโโโโโโโโ              โ
                        โ  Audio track     โโโโโโโโโโโโโโโโค
                        โ  โ Whisper API   โ              โ
                        โ  (transcribe)    โ              โ
                        โโโโโโโโโโฌโโโโโโโโโโ              โ
                                 โ                        โ
                                 โผ                        โผ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ  Combined Analysis Report           โ
                        โ  - Timeline of issues               โ
                        โ  - Frame thumbnails                 โ
                        โ  - Audio events (knocks, squeaks)   โ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### API Endpoint: `/api/analyze-video`

```typescript
// POST /api/analyze-video
// Content-Type: multipart/form-data

interface VideoAnalysisRequest {
  video: File;           // mp4, mov, webm (max 50MB)
  description?: string;  // Optional user description
}

interface VideoAnalysisResponse {
  success: boolean;
  duration: number;      // Video duration in seconds
  framesAnalyzed: number;
  
  timeline: Array<{
    timestamp: string;   // "0:05"
    frame: string;       // Base64 thumbnail
    observation: string; // What AI sees
    severity: 'info' | 'warning' | 'critical';
  }>;
  
  audioEvents?: Array<{
    timestamp: string;
    description: string; // "Metallic knocking sound"
    possibleCause: string;
  }>;
  
  overallDiagnosis: string;
  recommendations: string[];
}
```

### Frame Extraction (2 ะฒะฐัะธะฐะฝัะฐ):

**Option A: Client-side (ัะตะบะพะผะตะฝะดัะตััั ะดะปั v2)**
```typescript
// ะัะฟะพะปัะทัะตะผ HTML5 Video + Canvas
// ะะปััั: ะฑััััะพ, ะฝะต ะฝะฐะณััะถะฐะตั ัะตัะฒะตั
// ะะธะฝััั: ะทะฐะฒะธัะธั ะพั ะฑัะฐัะทะตัะฐ

const extractFrames = async (videoFile: File, interval: number = 3) => {
  const video = document.createElement('video');
  const canvas = document.createElement('canvas');
  // ... extract frame every N seconds
};
```

**Option B: Server-side (ะดะปั ัะปะพะถะฝัั ัะปััะฐะตะฒ)**
```typescript
// ะัะฟะพะปัะทัะตะผ ffmpeg ัะตัะตะท child_process
// ะะปััั: ะฝะฐะดัะถะฝะพ, ัะฐะฑะพัะฐะตั ั ะปัะฑัะผ ัะพัะผะฐัะพะผ
// ะะธะฝััั: ััะตะฑัะตั ffmpeg ะฝะฐ ัะตัะฒะตัะต, ะผะตะดะปะตะฝะฝะตะต
```

### UI ะบะพะผะฟะพะฝะตะฝัั:

1. **VideoUploadButton** โ ะฒ image picker dialog
2. **VideoAnalysisProgress** โ progress bar ั ะฟัะตะฒัั
3. **VideoTimeline** โ ัะตะทัะปััะฐั ั ะบะปะธะบะฐะฑะตะปัะฝัะผะธ ะผะพะผะตะฝัะฐะผะธ

---

## ๐ ะัะตะฝะบะฐ ัะตััััะพะฒ

| ะะพะผะฟะพะฝะตะฝั | ะกะปะพะถะฝะพััั | ะัะตะผั | API Costs |
|-----------|-----------|-------|-----------|
| API endpoint | Medium | 2-3 ั | โ |
| Client-side frame extraction | Medium | 2 ั | โ |
| Vision API integration | Low | 1 ั | ~$0.01/frame |
| Audio extraction + Whisper | High | 3-4 ั | ~$0.006/min |
| UI integration | Low | 1-2 ั | โ |
| Testing & edge cases | Medium | 2 ั | โ |

**ะะธะฝะธะผะฐะปัะฝะฐั ะฒะตััะธั (ะฑะตะท ะฐัะดะธะพ)**: ~6-8 ัะฐัะพะฒ, ~$0.05-0.10 per video
**ะะพะปะฝะฐั ะฒะตััะธั (ั ะฐัะดะธะพ)**: ~12-15 ัะฐัะพะฒ, ~$0.10-0.20 per video

---

## โ๏ธ ะขะตัะฝะธัะตัะบะธะต ะพะณัะฐะฝะธัะตะฝะธั

- **Max video length**: 60 ัะตะบัะฝะด (ัะตะบะพะผะตะฝะดัะตััั 30 ัะตะบ)
- **Max file size**: 50MB
- **Supported formats**: mp4, mov, webm
- **Frame extraction rate**: 1 frame per 2-3 seconds
- **Max frames per video**: 20-30

---

## ๐ ะกะฒัะทั ั ะดััะณะธะผะธ ัะธัะฐะผะธ

- ะะฝัะตะณัะธััะตััั ั ัััะตััะฒัััะธะผ Chat Interface
- ะัะฟะพะปัะทัะตั ัะพั ะถะต Vision API ััะพ ะธ ัะพัะพ-ะฐะฝะฐะปะธะท
- ะะตะทัะปััะฐัั ัะพััะฐะฝััััั ะฒ History

---

## ๐ Notes ะดะปั ัะตะฐะปะธะทะฐัะธะธ

1. ะะฐัะฐัั ั client-side extraction (ะฟัะพัะต, ะฑััััะตะต)
2. Audio analysis โ ะพัะดะตะปัะฝัะน ััะฐะฟ (ะผะพะถะฝะพ ะดะพะฑะฐะฒะธัั ะฟะพะทะถะต)
3. ะัะตะดััะผะพััะตัั fallback ะตัะปะธ extraction ะฝะต ัะฐะฑะพัะฐะตั
4. ะะพะฑะฐะฒะธัั preview ะฒะธะดะตะพ ะฟะตัะตะด ะพัะฟัะฐะฒะบะพะน
5. ะะพะบะฐะทัะฒะฐัั estimated cost ะฟะตัะตะด ะฐะฝะฐะปะธะทะพะผ (optional)

---

*ะกะพะทะดะฐะฝะพ: December 2024*
*ะะปั ะฒะตััะธะธ: 2.0*
